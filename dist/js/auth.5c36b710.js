(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["auth"],{"2fef":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-card",{staticClass:"mx-auto",attrs:{"max-width":"1032"}},[n("v-form",{ref:"myForm",staticClass:"mb-4",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{attrs:{counter:t.isLogin?null:"30",rules:t.emailRules,type:"email",label:"Email",required:""},model:{value:t.userEmail,callback:function(e){t.userEmail=e},expression:"userEmail"}}),n("v-text-field",{attrs:{counter:t.isLogin?null:"30",rules:t.passwordRules,type:"password",label:"Password",required:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitHandler(e)}},model:{value:t.userPassword,callback:function(e){t.userPassword=e},expression:"userPassword"}}),t.isLogin?t._e():n("v-text-field",{attrs:{counter:t.isLogin?null:"30",rules:t.rePasswordRules,type:"password",label:"Confirm password",required:""},model:{value:t.reUserPassword,callback:function(e){t.reUserPassword=e},expression:"reUserPassword"}}),n("div",{staticClass:"btns-container"},[n("v-btn",{staticClass:"auth-btn",attrs:{disabled:!t.valid,color:"success",width:"100%","max-width":"130"},on:{click:t.submitHandler}},[t._v(" "+t._s(t.isLogin?"Sign in":"Sign up")+" ")]),t.isLogin?t._e():n("p",{staticClass:"or-title"},[t._v("link password:")]),n("div",{staticClass:"google-btn-and-fixer-container"},[n("div",{staticClass:"google-text-fixer"},[t._v("Sign in with Google")]),n("GoogleLogin",{staticClass:"google-signin-btn-wrapper",attrs:{params:t.params,renderParams:t.renderParams,onSuccess:t.onSuccess,onFailure:t.onFailure}})],1),n("v-btn",{staticClass:"switch-to-register-btn",attrs:{color:"info",width:"100%","max-width":"130"},on:{click:t.switchHandler}},[t._v(" "+t._s(t.isLogin?"sign up":"sign in")+" ")]),t.isLogin?n("div",[n("v-btn",{staticClass:"demo-account-btn",attrs:{color:"brown",width:"100%","max-width":"224"},on:{click:t.demoHandler}},[t._v(" Try our demo account ")])],1):t._e()],1)],1)],1)],1)},i=[],r=n("a6f4"),s=n("e571"),a=n.n(s),d=Object(r["c"])({name:"Auth",components:{GoogleLogin:a.a},setup(t,{root:e}){Object(r["d"])(async()=>{"complete"!==document.readyState&&e.$store.dispatch("togLoading",{loadingStatus:!0})}),Object(r["e"])(()=>{window.onload=function(){e.$store.dispatch("togLoading",{loadingStatus:!1})}});const n=Object(r["g"])(""),o=Object(r["g"])(""),i=Object(r["g"])(""),s=Object(r["g"])(!0),a=Object(r["g"])(null),d=Object(r["g"])(!0),c=Object(r["g"])(""),l=Object(r["f"])([t=>!!t||"Email is required",t=>t&&t.length<=30||"Email must be less than 30 characters"]),u=Object(r["f"])([t=>!!t||"Password is required",t=>t&&t.length<=30||"Password must be less than 30 characters"]),g=Object(r["f"])([t=>!!t||"Confirm password is required",t=>t===o.value||"The password confirmation does not match."]),f=Object(r["f"])({client_id:"525617387179-qpf4t5s671j058shidk8c8ap9brdvhhe.apps.googleusercontent.com"}),m=Object(r["f"])({width:250,height:50,longtitle:!0}),p=async t=>{const n=t.uc?t.uc.id_token:t.tc.id_token;e.$store.dispatch("togLoading",{loadingStatus:!0});try{let t;if(s.value)t=await e.$store.dispatch({type:"signinOrSignupGoogle",token:n});else{const i={token:n,password:o.value};t=await e.$store.dispatch({type:"linkPassword",tokenAndPassword:i})}if(!t.isSuccess)return e.$store.dispatch("togLoading",{loadingStatus:!1}),e.$swal.fire({title:"Wrong credentials!",confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"});k(),t.showToast&&setTimeout(()=>{e.$swal.fire({text:"You can also login with your password",toast:!0,timer:3e3,position:"bottom",width:600,padding:"3em",background:"#fff"})},2e3)}catch(i){console.log(i),e.$swal.fire({title:"Error:",text:i.message.toString(),confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"})}e.$store.dispatch("togLoading",{loadingStatus:!1})},h=t=>{console.log("error: "),console.log(t)},w=t=>{if(t.keyboardEvent&&"Enter"===t.keyboardEvent.key&&!s.value)return;const e=a.value.validate();if(e){const t={userEmail:n.value,userPassword:o.value};s.value?y(t):_(t)}},v=()=>{s.value=!s.value,s.value||-1!==n.value.indexOf("demo")&&(n.value="",o.value="",a.value.reset())},b=()=>{n.value="demo@demo.com",o.value="demouser"},y=async t=>{e.$store.dispatch("togLoading",{loadingStatus:!0});try{const n=await e.$store.dispatch({type:"loginUser",userToAuthFields:t});if(!n)return e.$store.dispatch("togLoading",{loadingStatus:!1}),e.$swal.fire({title:"Wrong credentials!",confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"});setTimeout(()=>{e.$swal.fire({text:"You can also login with google",toast:!0,timer:3e3,position:"bottom",width:600,padding:"3em",background:"#fff"})},2e3),k()}catch(n){n.message.toString().includes("Wrong credentials!")?e.$swal.fire({title:"Wrong credentials!",confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"}):e.$swal.fire({text:n.message.toString()+" "+n.toString()+" "+n.graphQLErrors.toString(),confirmButtonColor:"#D62E1F",icon:"error",width:600,padding:"3em",background:"#fff"})}e.$store.dispatch("togLoading",{loadingStatus:!1})},_=async t=>{e.$store.dispatch("togLoading",{loadingStatus:!0});try{const n=await e.$store.dispatch({type:"createUser",userToAuthFields:t});if(!n)return e.$store.dispatch("togLoading",{loadingStatus:!1}),e.$swal.fire({title:"Error: login for new registered user failed!",text:"Please try again at a later time.",confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"});k()}catch(n){e.$swal.fire({title:"Error: register failed!",text:n.message.toString(),confirmButtonColor:"#D62E1F",icon:"error",width:600,padding:"3em",background:"#fff"})}e.$store.dispatch("togLoading",{loadingStatus:!1})},k=()=>{e.$router.push({name:"Start"})};return{userEmail:n,userPassword:o,reUserPassword:i,isLogin:s,myForm:a,valid:d,name:c,emailRules:l,passwordRules:u,rePasswordRules:g,params:f,renderParams:m,onSuccess:p,onFailure:h,submitHandler:w,loginUser:y,createUser:_,switchHandler:v,demoHandler:b,moveToStart:k}}}),c=d,l=(n("de1c"),n("2877")),u=Object(l["a"])(c,o,i,!1,null,"22a2e26a",null);e["default"]=u.exports},de1c:function(t,e,n){"use strict";var o=n("e955"),i=n.n(o);i.a},e571:function(t,e,n){!function(t,n){n(e)}(0,(function(t){"use strict";var e,n,o=function(t){return e?Promise.resolve(e):(n||(n=function(t){return new Promise((function(n,o){window.onGapiLoad=function(){window.gapi.load("auth2",(function(){try{e=window.gapi.auth2.init(Object.assign({},t))}catch(t){o({err:"client_id missing or is incorrect, or if you added extra params maybe they are written incorrectly, did you add it to the component or plugin?"})}n(e)}))}}))}(t)),n)},i=function(t,e){return t?t[e]():Promise.reject({err:"Script not loaded correctly, did you added the plugin or the client_id to the component?"})},r={load:function(t){return Promise.all([o(t),new Promise((function(t,e){if(!document.getElementById("auth2_script_id")){var n=document.createElement("script");n.setAttribute("src","https://apis.google.com/js/platform.js?onload=onGapiLoad"),n.setAttribute("async",!0),n.setAttribute("defer","defer"),n.setAttribute("id","auth2_script_id"),document.head.appendChild(n)}t()}))]).then((function(t){return t[0]}))},signIn:function(){return i(e,"signIn")},signOut:function(){return i(e,"signOut")},isSignedIn:function(){return i(e.isSignedIn,"get")},currentUser:function(){return i(e.currentUser,"get")},grantOfflineAccess:function(){return i(e,"grantOfflineAccess")}},s=0,a=function(t,e,n,o,i,r,s,a,d,c){"boolean"!=typeof s&&(d=a,a=s,s=!1);var l,u="function"==typeof n?n.options:n;if(t&&t.render&&(u.render=t.render,u.staticRenderFns=t.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),o&&(u._scopeId=o),r?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,d(t)),t&&t._registeredComponents&&t._registeredComponents.add(r)},u._ssrRegister=l):e&&(l=s?function(){e.call(this,c(this.$root.$options.shadowRoot))}:function(t){e.call(this,a(t))}),l)if(u.functional){var g=u.render;u.render=function(t,e){return l.call(e),g(t,e)}}else{var f=u.beforeCreate;u.beforeCreate=f?[].concat(f,l):[l]}return n}({render:function(){var t=this.$createElement,e=this._self._c||t;return this.renderParams&&!this.logoutButton?e("div",{attrs:{id:this.id},on:{click:this.handleClick}}):e("button",{attrs:{id:this.id},on:{click:this.handleClick}},[this._t("default")],2)},staticRenderFns:[]},void 0,{name:"GoogleLogin",props:{params:{type:Object,required:!0},onCurrentUser:{type:Function,default:function(){}},onSuccess:{type:Function,default:function(){}},onFailure:{type:Function,default:function(){}},logoutButton:{type:Boolean,default:!1},renderParams:{type:Object,required:!1}},beforeCreate:function(){this.id="google-signin-btn-".concat(s++)},methods:{handleClick:function(){var t=this,e=this.logoutButton?"signOut":"signIn";r[e]().then((function(e){return t.onSuccess(e)})).catch((function(e){return t.onFailure(e)}))}},mounted:function(){var t=this;r.load(this.params).then((function(){t.renderParams&&!1===t.logoutButton&&window.gapi.signin2.render(t.id,t.renderParams),r.isSignedIn()&&t.onCurrentUser(r.currentUser())})).catch((function(t){console.log(t)}))}},void 0,!1,void 0,void 0,void 0),d={install:function(t,e){t.GoogleAuth=r.load(e)}};t.GoogleLogin=a,t.LoaderPlugin=d,t.default=a,Object.defineProperty(t,"__esModule",{value:!0})}))},e955:function(t,e,n){}}]);
//# sourceMappingURL=auth.5c36b710.js.map