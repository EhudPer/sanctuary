(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["auth"],{"2fef":function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h1",{staticClass:"page-title"},[t._v(t._s(t.isLogin?"Login":"Register"))]),i("v-card",{staticClass:"mx-auto",attrs:{"max-width":"1032"}},[i("v-list-item",[i("v-list-item-avatar",{attrs:{color:"grey"}})],1),t.isLogin?i("v-img",{attrs:{src:o("d0cf"),alt:"Avatar","max-height":"150"}}):i("v-img",{attrs:{src:o("89ea"),alt:"Avatar","max-height":"150"}}),i("v-form",{ref:"myForm",staticClass:"mb-4",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[i("v-text-field",{attrs:{counter:30,rules:t.emailRules,type:"email",label:"Email",required:""},model:{value:t.userEmail,callback:function(e){t.userEmail=e},expression:"userEmail"}}),i("v-text-field",{attrs:{counter:30,rules:t.passwordRules,type:"password",label:"Password",required:""},model:{value:t.userPassword,callback:function(e){t.userPassword=e},expression:"userPassword"}}),t.isLogin?t._e():i("v-text-field",{attrs:{counter:30,rules:t.rePasswordRules,type:"password",label:"Confirm password",required:""},model:{value:t.reUserPassword,callback:function(e){t.reUserPassword=e},expression:"reUserPassword"}}),i("v-btn",{staticClass:"auth-btn",attrs:{disabled:!t.valid,color:"success",width:"100%","max-width":"130"},on:{click:t.submitHandler}},[t._v(" "+t._s(t.isLogin?"Login":"Register")+" ")]),i("v-btn",{staticClass:"reset-form-btn",attrs:{color:"error",width:"100%","max-width":"130"},on:{click:t.reset}},[t._v(" Reset Form ")]),i("v-btn",{staticClass:"reset-validation-btn",attrs:{color:"warning",width:"100%","max-width":"178"},on:{click:t.resetValidation}},[t._v(" Reset Validation ")]),t.isLogin?i("p",{staticClass:"or-title"},[t._v("Or:")]):i("p",{staticClass:"or-title"},[t._v("Or link password:")]),i("GoogleLogin",{staticClass:"google-signin-btn-wrapper",attrs:{params:t.params,renderParams:t.renderParams,onSuccess:t.onSuccess,onFailure:t.onFailure}}),i("p",{staticClass:"or-title"},[t._v("Or:")]),i("v-btn",{staticClass:"switch-to-register-btn",attrs:{color:"info",width:"100%","max-width":"198"},on:{click:t.switchHandler}},[t._v(" Switch to "+t._s(t.isLogin?"register":"login")+" ")]),t.isLogin?i("div",[i("p",{staticClass:"page-sub-title"},[t._v("For demo use only:")]),i("p",{staticClass:"page-sub-title"},[i("span",[t._v("Email: demo@demo.com")]),t._v(", "),i("span",[t._v("Password: demouser")])])]):t._e()],1)],1)],1)},n=[],r=o("a6f4"),s=o("e571"),a=o.n(s),c=Object(r["c"])({name:"Auth",components:{GoogleLogin:a.a},setup(t,{root:e}){"complete"!==document.readyState&&e.$store.dispatch("togLoading",{loadingStatus:!0}),Object(r["e"])(()=>{window.onload=function(){e.$store.dispatch("togLoading",{loadingStatus:!1})}});const o=Object(r["g"])(""),i=Object(r["g"])(""),n=Object(r["g"])(""),s=Object(r["g"])(!0),a=Object(r["g"])(null),c=Object(r["g"])(!0),d=Object(r["g"])(""),l=Object(r["f"])([t=>!!t||"Email is required",t=>t&&t.length<=30||"Email must be less than 30 characters"]),u=Object(r["f"])([t=>!!t||"Password is required",t=>t&&t.length<=30||"Password must be less than 30 characters"]),g=Object(r["f"])([t=>!!t||"Confirm password is required",t=>t===i.value||"The password confirmation does not match."]),f=Object(r["f"])({client_id:"525617387179-qpf4t5s671j058shidk8c8ap9brdvhhe.apps.googleusercontent.com"}),p=Object(r["f"])({width:250,height:50,longtitle:!0}),m=async t=>{const o=t.uc.id_token;e.$store.dispatch("togLoading",{loadingStatus:!0});try{let t;if(s.value)t=await e.$store.dispatch({type:"signinOrSignupGoogle",token:o});else{const n={token:o,password:i.value};t=await e.$store.dispatch({type:"linkPassword",tokenAndPassword:n})}if(!t.isSuccess)return e.$store.dispatch("togLoading",{loadingStatus:!1}),e.$swal.fire({title:"Wrong credentials!",confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"});S(),t.showToast&&setTimeout(()=>{e.$swal.fire({text:"You can also login with your password",toast:!0,timer:3e3,position:"bottom",width:600,padding:"3em",background:"#fff"})},2e3)}catch(n){console.log("error :"),console.log(n),e.$swal.fire({title:"Error:",text:n.message.toString(),confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"})}e.$store.dispatch("togLoading",{loadingStatus:!1})},h=()=>{console.log("error: ")},w=()=>{const t=a.value.validate();if(t){const t={userEmail:o.value,userPassword:i.value};s.value?y(t):C(t)}},v=()=>{a.value.reset()},b=()=>{a.value.resetValidation()},_=()=>{s.value=!s.value},y=async t=>{e.$store.dispatch("togLoading",{loadingStatus:!0});try{const o=await e.$store.dispatch({type:"loginUser",userToAuthFields:t});if(!o)return e.$store.dispatch("togLoading",{loadingStatus:!1}),e.$swal.fire({title:"Wrong credentials!",confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"});setTimeout(()=>{e.$swal.fire({text:"You can also login with google",toast:!0,timer:3e3,position:"bottom",width:600,padding:"3em",background:"#fff"})},2e3),S()}catch(o){o.message.toString().includes("Wrong credentials!")?e.$swal.fire({title:"Wrong credentials!",confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"}):e.$swal.fire({text:o.message.toString()+" "+o.toString()+" "+o.graphQLErrors.toString(),confirmButtonColor:"#D62E1F",icon:"error",width:600,padding:"3em",background:"#fff"})}e.$store.dispatch("togLoading",{loadingStatus:!1})},C=async t=>{e.$store.dispatch("togLoading",{loadingStatus:!0});try{const o=await e.$store.dispatch({type:"createUser",userToAuthFields:t});if(!o)return e.$store.dispatch("togLoading",{loadingStatus:!1}),e.$swal.fire({title:"Error: login for new registered user failed!",text:"Please try again at a later time.",confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"});S()}catch(o){e.$swal.fire({title:"Error: register failed!",text:o.message.toString(),confirmButtonColor:"#D62E1F",icon:"error",width:600,padding:"3em",background:"#fff"})}e.$store.dispatch("togLoading",{loadingStatus:!1})},S=()=>{e.$router.push({name:"AnimalsList"})};return{userEmail:o,userPassword:i,reUserPassword:n,isLogin:s,myForm:a,valid:c,name:d,emailRules:l,passwordRules:u,rePasswordRules:g,params:f,renderParams:p,onSuccess:m,onFailure:h,submitHandler:w,loginUser:y,createUser:C,reset:v,resetValidation:b,switchHandler:_,moveToAnimalsList:S}}}),d=c,l=(o("8af2"),o("2877")),u=Object(l["a"])(d,i,n,!1,null,"ba33ed32",null);e["default"]=u.exports},"89ea":function(t,e,o){t.exports=o.p+"img/register.e3ace350.jpg"},"8af2":function(t,e,o){"use strict";var i=o("c2af"),n=o.n(i);n.a},c2af:function(t,e,o){},d0cf:function(t,e,o){t.exports=o.p+"img/login.5e32f028.jpg"},e571:function(t,e,o){!function(t,o){o(e)}(0,(function(t){"use strict";var e,o,i=function(t){return e?Promise.resolve(e):(o||(o=function(t){return new Promise((function(o,i){window.onGapiLoad=function(){window.gapi.load("auth2",(function(){try{e=window.gapi.auth2.init(Object.assign({},t))}catch(t){i({err:"client_id missing or is incorrect, or if you added extra params maybe they are written incorrectly, did you add it to the component or plugin?"})}o(e)}))}}))}(t)),o)},n=function(t,e){return t?t[e]():Promise.reject({err:"Script not loaded correctly, did you added the plugin or the client_id to the component?"})},r={load:function(t){return Promise.all([i(t),new Promise((function(t,e){if(!document.getElementById("auth2_script_id")){var o=document.createElement("script");o.setAttribute("src","https://apis.google.com/js/platform.js?onload=onGapiLoad"),o.setAttribute("async",!0),o.setAttribute("defer","defer"),o.setAttribute("id","auth2_script_id"),document.head.appendChild(o)}t()}))]).then((function(t){return t[0]}))},signIn:function(){return n(e,"signIn")},signOut:function(){return n(e,"signOut")},isSignedIn:function(){return n(e.isSignedIn,"get")},currentUser:function(){return n(e.currentUser,"get")},grantOfflineAccess:function(){return n(e,"grantOfflineAccess")}},s=0,a=function(t,e,o,i,n,r,s,a,c,d){"boolean"!=typeof s&&(c=a,a=s,s=!1);var l,u="function"==typeof o?o.options:o;if(t&&t.render&&(u.render=t.render,u.staticRenderFns=t.staticRenderFns,u._compiled=!0,n&&(u.functional=!0)),i&&(u._scopeId=i),r?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,c(t)),t&&t._registeredComponents&&t._registeredComponents.add(r)},u._ssrRegister=l):e&&(l=s?function(){e.call(this,d(this.$root.$options.shadowRoot))}:function(t){e.call(this,a(t))}),l)if(u.functional){var g=u.render;u.render=function(t,e){return l.call(e),g(t,e)}}else{var f=u.beforeCreate;u.beforeCreate=f?[].concat(f,l):[l]}return o}({render:function(){var t=this.$createElement,e=this._self._c||t;return this.renderParams&&!this.logoutButton?e("div",{attrs:{id:this.id},on:{click:this.handleClick}}):e("button",{attrs:{id:this.id},on:{click:this.handleClick}},[this._t("default")],2)},staticRenderFns:[]},void 0,{name:"GoogleLogin",props:{params:{type:Object,required:!0},onCurrentUser:{type:Function,default:function(){}},onSuccess:{type:Function,default:function(){}},onFailure:{type:Function,default:function(){}},logoutButton:{type:Boolean,default:!1},renderParams:{type:Object,required:!1}},beforeCreate:function(){this.id="google-signin-btn-".concat(s++)},methods:{handleClick:function(){var t=this,e=this.logoutButton?"signOut":"signIn";r[e]().then((function(e){return t.onSuccess(e)})).catch((function(e){return t.onFailure(e)}))}},mounted:function(){var t=this;r.load(this.params).then((function(){t.renderParams&&!1===t.logoutButton&&window.gapi.signin2.render(t.id,t.renderParams),r.isSignedIn()&&t.onCurrentUser(r.currentUser())})).catch((function(t){console.log(t)}))}},void 0,!1,void 0,void 0,void 0),c={install:function(t,e){t.GoogleAuth=r.load(e)}};t.GoogleLogin=a,t.LoaderPlugin=c,t.default=a,Object.defineProperty(t,"__esModule",{value:!0})}))}}]);
//# sourceMappingURL=auth.3cd3ebee.js.map