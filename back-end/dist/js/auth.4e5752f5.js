(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["auth"],{"2fef":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("v-card",{staticClass:"mx-auto",attrs:{"max-width":"1032"}},[o("v-form",{ref:"myForm",staticClass:"mb-4",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[o("v-text-field",{attrs:{counter:e.isLogin?null:"30",rules:e.emailRules,type:"email",label:"Email",required:""},model:{value:e.userEmail,callback:function(t){e.userEmail=t},expression:"userEmail"}}),o("v-text-field",{attrs:{counter:e.isLogin?null:"30",rules:e.passwordRules,type:"password",label:"Password",required:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitHandler(t)}},model:{value:e.userPassword,callback:function(t){e.userPassword=t},expression:"userPassword"}}),e.isLogin?e._e():o("v-text-field",{attrs:{counter:e.isLogin?null:"30",rules:e.rePasswordRules,type:"password",label:"Confirm password",required:""},model:{value:e.reUserPassword,callback:function(t){e.reUserPassword=t},expression:"reUserPassword"}}),o("div",{staticClass:"btns-container"},[o("v-btn",{staticClass:"auth-btn",attrs:{disabled:!e.valid,color:"success",width:"100%","max-width":"130"},on:{click:e.submitHandler}},[e._v(" "+e._s(e.isLogin?"Sign in":"Sign up")+" ")]),e.isLogin?e._e():o("p",{staticClass:"or-title"},[e._v("link password:")]),o("div",{staticClass:"google-btn-and-fixer-container"},[o("div",{staticClass:"google-text-fixer"},[e._v("Sign in with Google")]),o("GoogleLogin",{staticClass:"google-signin-btn-wrapper",attrs:{params:e.params,renderParams:e.renderParams,onSuccess:e.onSuccess,onFailure:e.onFailure}})],1),o("v-btn",{staticClass:"switch-to-register-btn",attrs:{color:"info",width:"100%","max-width":"130"},on:{click:e.switchHandler}},[e._v(" "+e._s(e.isLogin?"sign up":"sign in")+" ")]),e.isLogin?o("div",[o("v-btn",{staticClass:"demo-account-btn",attrs:{color:"brown",width:"100%","max-width":"224"},on:{click:e.demoHandler}},[e._v(" Try our demo account ")])],1):e._e()],1)],1)],1)],1)},i=[],r=o("a6f4"),s=o("e571"),a=o.n(s),c=Object(r["c"])({name:"Auth",components:{GoogleLogin:a.a},setup(e,{root:t}){Object(r["d"])(async()=>{"complete"!==document.readyState&&t.$store.dispatch("togLoading",{loadingStatus:!0})}),Object(r["e"])(()=>{console.log(t.$el.querySelector(".abcRioButtonContents span")),console.log(t.$el.querySelector("#app")),console.log(t.$el),console.log(t.$el.querySelector('[id^="connected"]'));const e=document.querySelectorAll("span");console.log(e),window.onload=function(){t.$store.dispatch("togLoading",{loadingStatus:!1})}});const o=Object(r["g"])(""),n=Object(r["g"])(""),i=Object(r["g"])(""),s=Object(r["g"])(!0),a=Object(r["g"])(null),c=Object(r["g"])(!0),l=Object(r["g"])(""),d=Object(r["f"])([e=>!!e||"Email is required",e=>e&&e.length<=30||"Email must be less than 30 characters"]),u=Object(r["f"])([e=>!!e||"Password is required",e=>e&&e.length<=30||"Password must be less than 30 characters"]),g=Object(r["f"])([e=>!!e||"Confirm password is required",e=>e===n.value||"The password confirmation does not match."]),f=Object(r["f"])({client_id:"525617387179-qpf4t5s671j058shidk8c8ap9brdvhhe.apps.googleusercontent.com"}),m=Object(r["f"])({width:250,height:50,longtitle:!0}),p=async e=>{console.log("googleUser.uc",e.uc),console.log("googleUser",e);const o=e.uc?e.uc.id_token:e.tc.id_token;t.$store.dispatch("togLoading",{loadingStatus:!0});try{let e;if(s.value)e=await t.$store.dispatch({type:"signinOrSignupGoogle",token:o});else{const i={token:o,password:n.value};e=await t.$store.dispatch({type:"linkPassword",tokenAndPassword:i})}if(!e.isSuccess)return t.$store.dispatch("togLoading",{loadingStatus:!1}),t.$swal.fire({title:"Wrong credentials!",confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"});S(),e.showToast&&setTimeout(()=>{t.$swal.fire({text:"You can also login with your password",toast:!0,timer:3e3,position:"bottom",width:600,padding:"3em",background:"#fff"})},2e3)}catch(i){console.log(i),t.$swal.fire({title:"Error:",text:i.message.toString(),confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"})}t.$store.dispatch("togLoading",{loadingStatus:!1})},h=e=>{console.log("error: "),console.log(e)},w=e=>{if(console.log(e),e.keyboardEvent&&"Enter"===e.keyboardEvent.key&&!s.value)return;const t=a.value.validate();if(t){const e={userEmail:o.value,userPassword:n.value};s.value?y(e):_(e)}},v=()=>{s.value=!s.value,s.value||-1!==o.value.indexOf("demo")&&(o.value="",n.value="",a.value.reset())},b=()=>{o.value="demo@demo.com",n.value="demouser"},y=async e=>{t.$store.dispatch("togLoading",{loadingStatus:!0});try{const o=await t.$store.dispatch({type:"loginUser",userToAuthFields:e});if(!o)return t.$store.dispatch("togLoading",{loadingStatus:!1}),t.$swal.fire({title:"Wrong credentials!",confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"});setTimeout(()=>{t.$swal.fire({text:"You can also login with google",toast:!0,timer:3e3,position:"bottom",width:600,padding:"3em",background:"#fff"})},2e3),S()}catch(o){o.message.toString().includes("Wrong credentials!")?t.$swal.fire({title:"Wrong credentials!",confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"}):t.$swal.fire({text:o.message.toString()+" "+o.toString()+" "+o.graphQLErrors.toString(),confirmButtonColor:"#D62E1F",icon:"error",width:600,padding:"3em",background:"#fff"})}t.$store.dispatch("togLoading",{loadingStatus:!1})},_=async e=>{t.$store.dispatch("togLoading",{loadingStatus:!0});try{const o=await t.$store.dispatch({type:"createUser",userToAuthFields:e});if(!o)return t.$store.dispatch("togLoading",{loadingStatus:!1}),t.$swal.fire({title:"Error: login for new registered user failed!",text:"Please try again at a later time.",confirmButtonColor:"red",icon:"warning",width:600,padding:"3em",background:"#fff"});S()}catch(o){t.$swal.fire({title:"Error: register failed!",text:o.message.toString(),confirmButtonColor:"#D62E1F",icon:"error",width:600,padding:"3em",background:"#fff"})}t.$store.dispatch("togLoading",{loadingStatus:!1})},S=()=>{t.$router.push({name:"AnimalsList"})};return{userEmail:o,userPassword:n,reUserPassword:i,isLogin:s,myForm:a,valid:c,name:l,emailRules:d,passwordRules:u,rePasswordRules:g,params:f,renderParams:m,onSuccess:p,onFailure:h,submitHandler:w,loginUser:y,createUser:_,switchHandler:v,demoHandler:b,moveToAnimalsList:S}}}),l=c,d=(o("fc9a"),o("2877")),u=Object(d["a"])(l,n,i,!1,null,"626ddea4",null);t["default"]=u.exports},"5ea9":function(e,t,o){},e571:function(e,t,o){!function(e,o){o(t)}(0,(function(e){"use strict";var t,o,n=function(e){return t?Promise.resolve(t):(o||(o=function(e){return new Promise((function(o,n){window.onGapiLoad=function(){window.gapi.load("auth2",(function(){try{t=window.gapi.auth2.init(Object.assign({},e))}catch(e){n({err:"client_id missing or is incorrect, or if you added extra params maybe they are written incorrectly, did you add it to the component or plugin?"})}o(t)}))}}))}(e)),o)},i=function(e,t){return e?e[t]():Promise.reject({err:"Script not loaded correctly, did you added the plugin or the client_id to the component?"})},r={load:function(e){return Promise.all([n(e),new Promise((function(e,t){if(!document.getElementById("auth2_script_id")){var o=document.createElement("script");o.setAttribute("src","https://apis.google.com/js/platform.js?onload=onGapiLoad"),o.setAttribute("async",!0),o.setAttribute("defer","defer"),o.setAttribute("id","auth2_script_id"),document.head.appendChild(o)}e()}))]).then((function(e){return e[0]}))},signIn:function(){return i(t,"signIn")},signOut:function(){return i(t,"signOut")},isSignedIn:function(){return i(t.isSignedIn,"get")},currentUser:function(){return i(t.currentUser,"get")},grantOfflineAccess:function(){return i(t,"grantOfflineAccess")}},s=0,a=function(e,t,o,n,i,r,s,a,c,l){"boolean"!=typeof s&&(c=a,a=s,s=!1);var d,u="function"==typeof o?o.options:o;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),n&&(u._scopeId=n),r?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,c(e)),e&&e._registeredComponents&&e._registeredComponents.add(r)},u._ssrRegister=d):t&&(d=s?function(){t.call(this,l(this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),d)if(u.functional){var g=u.render;u.render=function(e,t){return d.call(t),g(e,t)}}else{var f=u.beforeCreate;u.beforeCreate=f?[].concat(f,d):[d]}return o}({render:function(){var e=this.$createElement,t=this._self._c||e;return this.renderParams&&!this.logoutButton?t("div",{attrs:{id:this.id},on:{click:this.handleClick}}):t("button",{attrs:{id:this.id},on:{click:this.handleClick}},[this._t("default")],2)},staticRenderFns:[]},void 0,{name:"GoogleLogin",props:{params:{type:Object,required:!0},onCurrentUser:{type:Function,default:function(){}},onSuccess:{type:Function,default:function(){}},onFailure:{type:Function,default:function(){}},logoutButton:{type:Boolean,default:!1},renderParams:{type:Object,required:!1}},beforeCreate:function(){this.id="google-signin-btn-".concat(s++)},methods:{handleClick:function(){var e=this,t=this.logoutButton?"signOut":"signIn";r[t]().then((function(t){return e.onSuccess(t)})).catch((function(t){return e.onFailure(t)}))}},mounted:function(){var e=this;r.load(this.params).then((function(){e.renderParams&&!1===e.logoutButton&&window.gapi.signin2.render(e.id,e.renderParams),r.isSignedIn()&&e.onCurrentUser(r.currentUser())})).catch((function(e){console.log(e)}))}},void 0,!1,void 0,void 0,void 0),c={install:function(e,t){e.GoogleAuth=r.load(t)}};e.GoogleLogin=a,e.LoaderPlugin=c,e.default=a,Object.defineProperty(e,"__esModule",{value:!0})}))},fc9a:function(e,t,o){"use strict";var n=o("5ea9"),i=o.n(n);i.a}}]);
//# sourceMappingURL=auth.4e5752f5.js.map